/*!
 * @flowlist/js-core v1.0.3
 * (c) 2020 falstack
 * https://github.com/flowlist/js-core#readme
 */
(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t():"function"===typeof define&&define.amd?define([],t):"object"===typeof exports?exports["jsCore"]=t():e["jsCore"]=t()})("undefined"!==typeof self?self:this,(function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s="fb15")}({8875:function(e,t,r){var n,o,c;(function(r,u){o=[],n=u,c="function"===typeof n?n.apply(t,o):n,void 0===c||(e.exports=c)})("undefined"!==typeof self&&self,(function(){function e(){var t=Object.getOwnPropertyDescriptor(document,"currentScript");if(!t&&"currentScript"in document&&document.currentScript)return document.currentScript;if(t&&t.get!==e&&document.currentScript)return document.currentScript;try{throw new Error}catch(s){var r,n,o,c=/.*at [^(]*\((.*):(.+):(.+)\)$/gi,u=/@([^@]*):(\d+):(\d+)\s*$/gi,i=c.exec(s.stack)||u.exec(s.stack),a=i&&i[1]||!1,f=i&&i[2]||!1,E=document.location.href.replace(document.location.hash,""),l=document.getElementsByTagName("script");a===E&&(r=document.documentElement.outerHTML,n=new RegExp("(?:[^\\n]+?\\n){0,"+(f-2)+"}[^<]*<script>([\\d\\D]*?)<\\/script>[\\d\\D]*","i"),o=r.replace(n,"$1").trim());for(var p=0;p<l.length;p++){if("interactive"===l[p].readyState)return l[p];if(l[p].src===a)return l[p];if(a===E&&l[p].innerHTML&&l[p].innerHTML.trim()===o)return l[p]}return null}}return e}))},fb15:function(e,t,r){"use strict";r.r(t);var n={};r.r(n),r.d(n,"generateDefaultField",(function(){return s})),r.d(n,"generateFieldName",(function(){return _})),r.d(n,"getObjectDeepValue",(function(){return T})),r.d(n,"updateObjectDeepValue",(function(){return y})),r.d(n,"computeMatchedItemIndex",(function(){return d})),r.d(n,"combineArrayData",(function(){return b})),r.d(n,"isArray",(function(){return O})),r.d(n,"setReactivityField",(function(){return g})),r.d(n,"computeResultLength",(function(){return S})),r.d(n,"generateRequestParams",(function(){return v}));var o={};if(r.r(o),r.d(o,"initState",(function(){return D})),r.d(o,"initData",(function(){return j})),r.d(o,"loadMore",(function(){return L})),r.d(o,"updateState",(function(){return N})),"undefined"!==typeof window){var c=window.document.currentScript,u=r("8875");c=u(),"currentScript"in document||Object.defineProperty(document,"currentScript",{get:u});var i=c&&c.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);i&&(r.p=i[1])}var a={SETTER_TYPE:{RESET:0,MERGE:1},FETCH_TYPE:{PAGINATION:"jump",SINCE_FIRST_OR_END_ID:"sinceId",SCROLL_LOAD_MORE:"page",HAS_LOADED_IDS:"seenIds"},CHANGE_TYPE:{RESET_FIELD:"reset",UPDATE_RESULT:"update",RESULT_ADD_AFTER:"push",RESULT_ADD_BEFORE:"unshift",RESULT_REMOVE_BY_ID:"delete",RESULT_INSERT_TO_BEFORE:"insert-before",RESULT_INSERT_TO_AFTER:"insert-after",RESULT_LIST_MERGE:"patch"},FIELD_DATA:{RESULT_KEY:"result",EXTRA_KEY:"extra"},FETCH_PARAMS_DEFAULT:{CHANGE_KEY_NAME:"id"}};function f(e){return f="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}function E(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?E(Object(r),!0).forEach((function(t){p(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function p(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return l(l({},{result:[],noMore:!1,nothing:!1,loading:!1,error:null,extra:null,fetched:!1,page:0,total:0}),e)},_=function(e){var t=e.func,r=e.type,n=e.query,o=void 0===n?{}:n,c="".concat(t,"-").concat(r);return Object.keys(o).filter((function(e){return!~["undefined","object","function"].indexOf(f(o[e]))&&!~["page","is_up","since_id","seen_ids","__refresh__","__reload__"].indexOf(e)})).sort().forEach((function(e){c+="-".concat(e,"-").concat(o[e])})),c},T=function(e,t){if(!t)return e;var r=e,n=O(t)?t:t.split(".");return n.forEach((function(e){r=r[e]})),r},y=function(e,t,r){if(/\./.test(t)){var n=t.split("."),o=n.pop(),c=e;n.forEach((function(e){c=c[e]})),c[o]=r}else e[t]=r},d=function(e,t,r){for(var n=-1,o=0;o<t.length;o++)if(T(t[o],r).toString()===e.toString()){n=o;break}return n},b=function(e,t,r){O(t)?t.forEach((function(t){var n=T(t,r).toString();e.forEach((function(o,c){T(o,r).toString()===n&&(e[c]=l(l({},o),t))}))})):Object.keys(t).forEach((function(n){var o=n.toString();e.forEach((function(c,u){T(c,r).toString()===o&&(e[u]=l(l({},c),t[n]))}))}))},O=function(e){return"[object Array]"===Object.prototype.toString.call(e)},g=function(e,t,r,n,o){n!==a.FETCH_TYPE.PAGINATION?O(r)?e[t]=o?r.concat(e[t]||[]):(e[t]||[]).concat(r):t===a.FIELD_DATA.RESULT_KEY?(O(e[t])&&(e[t]={}),Object.keys(r).forEach((function(n){e[t][n]=e[t][n]?o?r[n].concat(e[t][n]):e[t][n].concat(r[n]):r[n]}))):e[t]=r:e[t]=r},S=function(e){var t=0;return O(e)?t=e.length:Object.keys(e).forEach((function(r){t+=e[r].length})),t},v=function(e){var t=e.field,r=e.uniqueKey,n=e.query,o=e.type,c={};if(t.fetched){var u=r||a.FETCH_PARAMS_DEFAULT.CHANGE_KEY_NAME;o===a.FETCH_TYPE.HAS_LOADED_IDS?c.seen_ids=t.result.map((function(e){return T(e,u)})).join(","):o===a.FETCH_TYPE.SINCE_FIRST_OR_END_ID?(c.since_id=T(t.result[n.is_up?0:t.result.length-1],u),c.is_up=n.is_up?1:0):o===a.FETCH_TYPE.PAGINATION?c.page=n.page:o===a.FETCH_TYPE.SCROLL_LOAD_MORE&&(c.page=t.page+1)}else o===a.FETCH_TYPE.HAS_LOADED_IDS?c.seen_ids="":o===a.FETCH_TYPE.SINCE_FIRST_OR_END_ID?(c.since_id=n.sinceId||(n.is_up?999999999:0),c.is_up=n.is_up?1:0):o===a.FETCH_TYPE.PAGINATION?c.page=n.page||t.page:o===a.FETCH_TYPE.SCROLL_LOAD_MORE&&(c.page=t.page);return l(l({},n),c)},h=function(e){var t=e.getter,r=e.setter,n=e.cache,o=e.data,c=e.fieldName,u=e.type,i=e.fromLocal,f=e.cacheTimeout,E=e.page,l=e.insertBefore;return new Promise((function(e,p){if(i)r({key:c,type:a.SETTER_TYPE.RESET,value:o,callback:function(){e()}});else{var s=t(c);if(s){var _=o.result,T=o.extra;s.nothing=!s.fetched&&0===S(_),s.fetched=!0,s.total=o.total||0,u===a.FETCH_TYPE.PAGINATION?(s.noMore=!1,s.page=+E):(s.noMore=o.no_more||!1,s.page=s.page+1),s.loading=!1,g(s,a.FIELD_DATA.RESULT_KEY,_,u,l),T&&g(s,a.FIELD_DATA.EXTRA_KEY,T,u,l),r({key:c,type:a.SETTER_TYPE.RESET,value:s,callback:function(){!f||s.nothing?e():n.set({key:c,value:s,timeout:f}).then(e).catch(e)}})}else p()}}))},P=function(e){var t=e.setter,r=e.fieldName,n=e.error;t({key:r,type:a.SETTER_TYPE.MERGE,value:{error:n,loading:!1}})};function m(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function R(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?m(Object(r),!0).forEach((function(t){A(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function A(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var D=function(e){var t=e.getter,r=e.setter,n=e.func,o=e.type,c=e.query,u=e.opts,i=void 0===u?{}:u;return new Promise((function(e){var u=_({func:n,type:o,query:c}),f=t(u);f?e():r({key:u,type:a.SETTER_TYPE.RESET,value:s(i),callback:function(){e()}})}))},j=function(e){var t=e.getter,r=e.setter,n=e.cache,o=e.func,c=e.type,u=e.query,i=e.api,f=e.cacheTimeout,E=e.uniqueKey,l=e.callback;return new Promise((function(e,p){var T=_({func:o,type:c,query:u}),y=t(T),d=!!u.__refresh__,b=!!u.__reload__;if(y&&y.error&&!d)return e();if(y&&y.loading)return e();var O=y&&y.fetched&&!d;if(O)return e();var g=v({field:R(R({},y),{},{fetched:!1}),uniqueKey:E,query:u,type:c}),S=!1,m=function(){var u=function(){return new Promise((function(e){var t=function(){i[o](g).then(e).catch((function(e){P({setter:r,fieldName:T,error:e}),p(e)}))};f?n.get({key:T}).then((function(t){S=!0,e(t)})).catch((function(){t()})):t()}))};u().then((function(o){var u=function(){h({getter:t,setter:r,cache:n,data:o,fieldName:T,type:c,fromLocal:S,cacheTimeout:f,page:g.page,insertBefore:!1}).then((function(){l&&l({params:g,data:o,refresh:d}),e()}))};b?r({key:T,type:a.SETTER_TYPE.RESET,value:s(),callback:u}):u()}))};O||b?m():r({key:T,type:a.SETTER_TYPE.RESET,value:R(R({},s()),{},{loading:!0,error:null}),callback:m})}))},L=function(e){var t=e.getter,r=e.setter,n=e.cache,o=e.query,c=e.type,u=e.func,i=e.api,f=e.cacheTimeout,E=e.uniqueKey,l=e.errorRetry,p=e.callback;return new Promise((function(e,s){var T=_({func:u,type:c,query:o}),y=t(T);if(!y)return e();if(y.loading)return e();if(y.nothing)return e();if(y.noMore&&!l)return e();if(c===a.FETCH_TYPE.PAGINATION&&+o.page===y.page)return e();var d={loading:!0,error:null};c===a.FETCH_TYPE.PAGINATION&&(d.result=[],d.extra=null);var b=v({field:y,uniqueKey:E,query:o,type:c});b._extra=y.extra;var O=function(){i[u](b).then((function(u){h({getter:t,setter:r,cache:n,data:u,fieldName:T,type:c,fromLocal:!1,cacheTimeout:f,page:b.page,insertBefore:!!o.is_up}).then((function(){p&&p({params:b,data:u,refresh:!1}),e()}))})).catch((function(e){P({setter:r,fieldName:T,error:e}),s(e)}))};r({key:T,type:a.SETTER_TYPE.MERGE,value:d,callback:O})}))},N=function(e){var t=e.getter,r=e.setter,n=e.cache,o=e.type,c=e.func,u=e.query,i=e.method,f=e.value,E=e.id,l=void 0===E?"":E,p=e.uniqueKey,s=void 0===p?a.FETCH_PARAMS_DEFAULT.CHANGE_KEY_NAME:p,g=e.changeKey,v=void 0===g?a.FIELD_DATA.RESULT_KEY:g,h=e.cacheTimeout;return new Promise((function(e,E){var p=_({func:c,type:o,query:u}),g=t(p);if(g){var P=S(g.result);if(i===a.CHANGE_TYPE.UPDATE_RESULT){var m=d(l,g.result,s);y(g.result[m],v,f)}else if(i===a.CHANGE_TYPE.RESET_FIELD)y(g,v,f);else{var R=T(g,v),A=d(l,R,s);switch(i){case a.CHANGE_TYPE.RESULT_ADD_AFTER:O(f)?R=R.concat(f):R.push(f);break;case a.CHANGE_TYPE.RESULT_ADD_BEFORE:O(f)?R=f.concat(R):R.unshift(f);break;case a.CHANGE_TYPE.RESULT_REMOVE_BY_ID:A>=0&&R.splice(A,1);break;case a.CHANGE_TYPE.RESULT_INSERT_TO_BEFORE:A>=0&&R.splice(A,0,f);break;case a.CHANGE_TYPE.RESULT_INSERT_TO_AFTER:A>=0&&R.splice(A+1,0,f);break;case a.CHANGE_TYPE.RESULT_LIST_MERGE:b(R,f,s);break}g[v]=R}var D=S(g.result);g.total=g.total+D-P,g.nothing=0===D,r({key:p,type:a.SETTER_TYPE.MERGE,value:g,callback:function(){h?n.set({key:p,value:g,timeout:h}).then(e).catch(e):e()}})}else E()}))};function I(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Y(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?I(Object(r),!0).forEach((function(t){F(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):I(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function F(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var w=Y({utils:n},o);t["default"]=w}})["default"]}));